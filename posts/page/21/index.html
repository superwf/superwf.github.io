<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    
    <title>老王的日志</title>
    <meta name="viewport" content="width=device-width,minimum-scale=1">
    <meta name="generator" content="Hugo 0.68.3" />
    
    
      <META NAME="ROBOTS" CONTENT="NOINDEX, NOFOLLOW">
    

    
    
      <link href="/dist/css/app.1cb140d8ba31d5b2f1114537dd04802a.css" rel="stylesheet">
    

    

    
      
    

    
    
      <link href="/posts/index.xml" rel="alternate" type="application/rss+xml" title="老王的日志" />
      <link href="/posts/index.xml" rel="feed" type="application/rss+xml" title="老王的日志" />
      
    
    
    <meta property="og:title" content="Posts" />
<meta property="og:description" content="" />
<meta property="og:type" content="website" />
<meta property="og:url" content="http://superwf.github.io/posts/" />
<meta property="og:updated_time" content="2020-04-29T01:53:50+00:00" />
<meta itemprop="name" content="Posts">
<meta itemprop="description" content=""><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Posts"/>
<meta name="twitter:description" content=""/>

  </head>

  <body class="ma0 avenir bg-near-white">

    

  <header>
    <div class="pb3-m pb6-l bg-black">
      <nav class="pv3 ph3 ph4-ns" role="navigation">
  <div class="flex-l justify-between items-center center">
    <a href="http://superwf.github.io/" class="f3 fw2 hover-white no-underline white-90 dib">
      老王的日志
    </a>
    <div class="flex-l items-center">
      

      
        <ul class="pl0 mr3">
          
          <li class="list f5 f4-ns fw4 dib pr3">
            <a class="hover-white no-underline white-90" href="/migrate2020/" title="migrate2020 page">
              migrate2020
            </a>
          </li>
          
          <li class="list f5 f4-ns fw4 dib pr3">
            <a class="hover-white no-underline white-90" href="/coder-life/" title="coder-life page">
              coder-life
            </a>
          </li>
          
        </ul>
      
      














    </div>
  </div>
</nav>

      <div class="tc-l pv3 ph3 ph4-ns">
        <h1 class="f2 f-subheadline-l fw2 light-silver mb0 lh-title">
          Posts
        </h1>
        
      </div>
    </div>
  </header>


    <main class="pb7" role="main">
      
  <article class="pa3 pa4-ns nested-copy-line-height nested-img">
    <section class="cf ph3 ph5-l pv3 pv4-l f4 tc-l center measure-wide lh-copy mid-gray"></section>
    <section class="flex-ns flex-wrap justify-around mt5">
      
        <div class="relative w-100 w-30-l mb4 bg-white"><div class="relative w-100 mb4 bg-white nested-copy-line-height">
  <div class="bg-white mb3 pa4 gray overflow-hidden">
    <span class="f6 db">Posts</span>
    <h1 class="f3 near-black">
      <a href="http://superwf.github.io/p293/" class="link black dim">
        dia无法输入中文问题
      </a>
    </h1>
    <div class="nested-links f5 lh-copy nested-copy-line-height">
      http://www.ubuntu-tw.org/modules/newbb/viewtopic.php?topic_id=48402&amp;post_id=222438
参考了这个，又折腾了半天gcin，scim，全都不灵
后来在第二页看到了一个提示，把菜单里的dia命令换成dia-gnome
用dia-gnome启动后一切OK
    </div>
  </div>
</div>
</div>
      
        <div class="relative w-100 w-30-l mb4 bg-white"><div class="relative w-100 mb4 bg-white nested-copy-line-height">
  <div class="bg-white mb3 pa4 gray overflow-hidden">
    <span class="f6 db">Posts</span>
    <h1 class="f3 near-black">
      <a href="http://superwf.github.io/p289/" class="link black dim">
        一个建立rails新程序的向导
      </a>
    </h1>
    <div class="nested-links f5 lh-copy nested-copy-line-height">
      rails new rails3-devise-rspec-cucumber -m https://raw.github.com/RailsApps/rails3-application-templates/master/rails3-devise-rspec-cucumber-template.rb
    </div>
  </div>
</div>
</div>
      
        <div class="relative w-100 w-30-l mb4 bg-white"><div class="relative w-100 mb4 bg-white nested-copy-line-height">
  <div class="bg-white mb3 pa4 gray overflow-hidden">
    <span class="f6 db">Posts</span>
    <h1 class="f3 near-black">
      <a href="http://superwf.github.io/p279/" class="link black dim">
        ibm 3650 m3 bnx2/bnx2-rv2p-09ax-5.0.0.j3.fw
      </a>
    </h1>
    <div class="nested-links f5 lh-copy nested-copy-line-height">
      这个服务器运行了半年多，忽然发现反应慢半拍。之前提到的升级的那个破dell，6、7年前的机器ssh进去之后，进入目录，命令补全什么的都很速度。
按说ibm3650这个还是前年的新机器，竟然很慢。
据于工说是ibm的硬盘驱动问题，系统默认可能识别驱动不对。
于是安装了firmware-linux-nonfree
之后报系统错误。
update-initramfs: Generating /boot/initrd.img-2.6.32-5-amd64
W: Possible missing firmware /lib/firmware/bnx2/bnx2-rv2p-09ax-5.0.0.j3.fw for module bnx2
W: Possible missing firmware /lib/firmware/bnx2/bnx2-rv2p-06-5.0.0.j3.fw for module bnx2
W: Possible missing firmware /lib/firmware/bnx2/bnx2-mips-06-5.0.0.j3.fw for module bnx2
又说缺这个，搜了
http://packages.debian.org/squeeze/firmware-bnx2
说是网卡的驱动，总之装上
之后反应就迅速起来了。
    </div>
  </div>
</div>
</div>
      
        <div class="relative w-100 w-30-l mb4 bg-white"><div class="relative w-100 mb4 bg-white nested-copy-line-height">
  <div class="bg-white mb3 pa4 gray overflow-hidden">
    <span class="f6 db">Posts</span>
    <h1 class="f3 near-black">
      <a href="http://superwf.github.io/p276/" class="link black dim">
        网络启动安装linux
      </a>
    </h1>
    <div class="nested-links f5 lh-copy nested-copy-line-height">
      之前配置过网络启动安装系统。当时还有于工一起鼓捣，他弄了个网络pxe安装win2003，这个我一直都不会，不过因为是win的东西…
最近又要装个老服务器，光驱接口不通用，有usb但不支持usb启动，还好支持pxe。
今天又配置了一下，参考这个
http://www.ixpub.net/thread-1127829-1-1.html
最后我的dhcpd.conf内容如下
class “pxeclients” {
match if substring (option vendor-class-identifier, 0, 9) = “PXEClient”;
option vendor-class-identifier “PXEClient”;
vendor-option-space PXE;
option PXE.mtftp-ip 0.0.0.0;
filename “pxelinux.0”;
next-server 10.0.0.70;
}
allow booting;
allow bootp;
subnet 10.0.0.0 netmask 255.255.255.0 {
range 10.0.0.101 10.0.0.200;
option routers 10.0.0.1;
option domain-name-servers 10.0.0.70;
}
group {
next-server 10.0.0.70;
#host tftpclient {
# filename “pxelinux.0”;
#}
filename “pxelinux.0”;
}
一开始在163上下了个debian的网络启动文件。有些教程上说要下载pxelinux.0 mini.iso
其实都不用，就下载netboot.tar.gz一个文件，然后解压就都有了。
解压后会有pxelinux.0这个文件。
中间发生了点问题，目标服务器是dell poweredge 1750。
    </div>
  </div>
</div>
</div>
      
        <div class="relative w-100 w-30-l mb4 bg-white"><div class="relative w-100 mb4 bg-white nested-copy-line-height">
  <div class="bg-white mb3 pa4 gray overflow-hidden">
    <span class="f6 db">Posts</span>
    <h1 class="f3 near-black">
      <a href="http://superwf.github.io/p274/" class="link black dim">
        incompatible character encodings: UTF-8 and ASCII-8BIT
      </a>
    </h1>
    <div class="nested-links f5 lh-copy nested-copy-line-height">
      有一个页面，上传csv并解析后存如数据库，如果解析格式错误则render之前的页面提示错误。
有个问题，上传文件中的字符出错后，如果该字符中包含非ascii字符页面就会报错
incompatible character encodings: UTF-8 and ASCII-8BIT
网上说了好多都说数据库连接方面的修改。我这个是直接解析上传文件，还没有涉及到数据库连接上，整个程序都是utf-8编码，config.encoding也已经设置。
后来参考http://www.cnblogs.com/kting/archive/2011/09/15/2177530.html
后来发现问题出在上传文件的读入上
params[:upload_file].read.encoding
返回的字符串的encoding是 ASCII－8BIT
在这里用params[:upload_file].read.force_encoding(“utf-8”)
之后就正常了。
其间还测试了Iconv.iconv方法，不过不灵，还试了String#toutf8方法，结果字符串变成了空白的，不清楚这个方法是干什么的。
    </div>
  </div>
</div>
</div>
      
        <div class="relative w-100 w-30-l mb4 bg-white"><div class="relative w-100 mb4 bg-white nested-copy-line-height">
  <div class="bg-white mb3 pa4 gray overflow-hidden">
    <span class="f6 db">Posts</span>
    <h1 class="f3 near-black">
      <a href="http://superwf.github.io/p272/" class="link black dim">
        prawn生成的pdf在chrome中直接显示
      </a>
    </h1>
    <div class="nested-links f5 lh-copy nested-copy-line-height">
      今天要调试个pdf生成页面，为了调试方便希望在chrome里直接显示pdf，这样每次刷新就可以看到pdf的变化。
刚开始一点击pdf后浏览器总是自动下载文件。
以为是nginx或者rails里mime的什么设置的问题，后来在controller里的send_data有个参数
disposition: “inline”
之后pdf就能直接显示在chrome里了。
    </div>
  </div>
</div>
</div>
      
        <div class="relative w-100 w-30-l mb4 bg-white"><div class="relative w-100 mb4 bg-white nested-copy-line-height">
  <div class="bg-white mb3 pa4 gray overflow-hidden">
    <span class="f6 db">Posts</span>
    <h1 class="f3 near-black">
      <a href="http://superwf.github.io/p269/" class="link black dim">
        rubygems-bunlder不用每次都执行bundle exec
      </a>
    </h1>
    <div class="nested-links f5 lh-copy nested-copy-line-height">
      找到这么一个好东西
https://github.com/mpapis/rubygems-bundler
安装之后，每次进入程序主目录之后，执行rails、rake等命令
会自动根据当前程序Gemfile里的版本执行对应的程序。
省略了每次必须先敲bundle exec的麻烦。
可喜可贺
    </div>
  </div>
</div>
</div>
      
        <div class="relative w-100 w-30-l mb4 bg-white"><div class="relative w-100 mb4 bg-white nested-copy-line-height">
  <div class="bg-white mb3 pa4 gray overflow-hidden">
    <span class="f6 db">Posts</span>
    <h1 class="f3 near-black">
      <a href="http://superwf.github.io/p267/" class="link black dim">
        rails aototest not running
      </a>
    </h1>
    <div class="nested-links f5 lh-copy nested-copy-line-height">
      在一个新的rails3.2的程序里，打算用郭老师推荐的autotest
可是按教程写的载入之后，运行autotest之后，进程就卡住，根本不往下走，完全不像autotest教程上说的，先自动整体测试一遍。
google之后说是因为rspec升级为rspec2的缘故
在程序主文件夹里放入文件夹 ./autotest/discover.rb
内容为
Autotest.add_discovery { “rspec2” }
然后再执行autotest就能自动执行了。
    </div>
  </div>
</div>
</div>
      
        <div class="relative w-100 w-30-l mb4 bg-white"><div class="relative w-100 mb4 bg-white nested-copy-line-height">
  <div class="bg-white mb3 pa4 gray overflow-hidden">
    <span class="f6 db">Posts</span>
    <h1 class="f3 near-black">
      <a href="http://superwf.github.io/p263/" class="link black dim">
        libreadline.so.5 undefined symbol problem导致reiserfs分区加载不了
      </a>
    </h1>
    <div class="nested-links f5 lh-copy nested-copy-line-height">
      昨天由于rails c命令报错，说缺少readline这个库，调试了一些什么，具体的也想不起来了。
今天一开机，报readline错误，而且几个lvm里的reiserfs分区也找不到了！
一开始还以为是分区损坏，数据完蛋了。
vgdisplay就报错
symbol lookup error: /usr/local/lib/libreadline.so.5: undefined symbol
后来google一下说是readline的问题
按这个帖子说的
http://ubuntuforums.org/showthread.php?t=269022
把几个readline的文件都删了，然后ldconfig更新一下。
竟然就好了。
加密分区也回来了，可喜可贺！
    </div>
  </div>
</div>
</div>
      
        <div class="relative w-100 w-30-l mb4 bg-white"><div class="relative w-100 mb4 bg-white nested-copy-line-height">
  <div class="bg-white mb3 pa4 gray overflow-hidden">
    <span class="f6 db">Posts</span>
    <h1 class="f3 near-black">
      <a href="http://superwf.github.io/p258/" class="link black dim">
        debian gpg
      </a>
    </h1>
    <div class="nested-links f5 lh-copy nested-copy-line-height">
      升级wheezy之后需要装smplayer
在sources.list里加入了
deb http://www.debian-multimedia.org wheezy main non-free
aptitude update之后
由于没有公钥，下列签名无法进行验证： NO_PUBKEY 07DC563D1F41B907
按http://www.debian-multimedia.org/上写的
先装上debian-multimedia-keyring
装上这个的意义应该就在于导入公钥
顺便了解了一下gpg命令
gpg –keyserver keyserver.ubuntu.com –search-keys 07DC563D1F41B907
如果在公钥服务器上找到，导入之
gpg –keyserver keyserver.ubuntu.com –recv 07DC563D1F41B907
gpg –export –a 07DC563D1F41B907 | sudo apt-key add –
后来知道apt-key这个命令的adv参数直接将后面的参数传递给gpg
apt-key adv –keyserver keyserver.ubuntu.com –recv-keys D1F41B907
D1F41B907就是刚才key的后8位。
前面的那几个命令就用这一个就可以替代了。
有些key在keyserver.ubuntu.com找不到，可以换wwwkeys.pgp.net试试。
先gpg –list-keys看了一下，我这个系统里还存着去年的过是的key，是squeeze安装iceweasel用的
用gpg –delete-keys xxxxxxx删除之
    </div>
  </div>
</div>
</div>
      
    </section>

<ul class="pagination">
    
    <li class="page-item">
        <a href="/posts/" class="page-link" aria-label="First"><span aria-hidden="true">&laquo;&laquo;</span></a>
    </li>
    
    <li class="page-item">
    <a href="/posts/page/20/" class="page-link" aria-label="Previous"><span aria-hidden="true">&laquo;</span></a>
    </li>
    
    
    
    
    
    
    
        
        
    
    
    <li class="page-item"><a class="page-link" href="/posts/">1</a></li>
    
    
    
    
    
    
        
        
    
    
    <li class="page-item"><a class="page-link" href="/posts/page/2/">2</a></li>
    
    
    
    
    
    
        
        
    
    
    <li class="page-item"><a class="page-link" href="/posts/page/3/">3</a></li>
    
    
    
    
    
    
        
        
    
    
    <li class="page-item disabled"><span aria-hidden="true">&nbsp;&hellip;&nbsp;</span></li>
    
    
    
    
    
    
        
        
    
    
    
    
    
    
    
        
        
    
    
    
    
    
    
    
        
        
    
    
    
    
    
    
    
        
        
    
    
    
    
    
    
    
        
        
    
    
    
    
    
    
    
        
        
    
    
    
    
    
    
    
        
        
    
    
    
    
    
    
    
        
        
    
    
    
    
    
    
    
        
        
    
    
    
    
    
    
    
        
        
    
    
    
    
    
    
    
        
        
    
    
    
    
    
    
    
        
        
    
    
    
    
    
    
    
        
        
    
    
    
    
    
    
    
        
        
    
    
    
    
    
    
    
        
        
    
    
    
    
    
    
    
        
        
    
    
    <li class="page-item"><a class="page-link" href="/posts/page/20/">20</a></li>
    
    
    
    
    
    
        
        
    
    
    <li class="page-item active"><a class="page-link" href="/posts/page/21/">21</a></li>
    
    
    
    
    
    
        
        
    
    
    <li class="page-item"><a class="page-link" href="/posts/page/22/">22</a></li>
    
    
    
    
    
    
        
        
    
    
    <li class="page-item disabled"><span aria-hidden="true">&nbsp;&hellip;&nbsp;</span></li>
    
    
    
    
    
    
        
        
    
    
    
    
    
    
    
        
        
    
    
    
    
    
    
    
        
        
    
    
    
    
    
    
    
        
        
    
    
    
    
    
    
    
        
        
    
    
    <li class="page-item"><a class="page-link" href="/posts/page/28/">28</a></li>
    
    
    <li class="page-item">
    <a href="/posts/page/22/" class="page-link" aria-label="Next"><span aria-hidden="true">&raquo;</span></a>
    </li>
    
    <li class="page-item">
        <a href="/posts/page/28/" class="page-link" aria-label="Last"><span aria-hidden="true">&raquo;&raquo;</span></a>
    </li>
    
</ul>

</article>

    </main>
    <footer class="bg-black bottom-0 w-100 pa3" role="contentinfo">
  <div class="flex justify-between">
  <a class="f4 fw4 hover-white no-underline white-70 dn dib-ns pv2 ph3" href="http://superwf.github.io/" >
    &copy;  老王的日志 2020 
  </a>
    <div>













</div>
  </div>
</footer>

    

  <script src="/dist/js/app.3fc0f988d21662902933.js"></script>


  </body>
</html>
